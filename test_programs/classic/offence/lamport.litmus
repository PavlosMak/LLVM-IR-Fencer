X86 Lamport-F

{}

 P0           | P1           ;
 while1:      | while2:      ;
 MOV [b1],$1  | MOV [b2],$1  ;
 MOV [x],$1   | MOV [x],$2   ;
 CMP  [y],$0  | CMP  [y],$0  ;
 JE notif1    | JE notif3    ;
 MOV [b1],$0  | MOV [b2],$0  ;
 waitbar1:    | waitbar4:    ;
 CMP  [y],$0  | CMP  [y],$0  ;
 JE while1    | JE while2    ;
 JMP waitbar1 | JMP waitbar4 ;
 notif1:      | notif3:      ;
 MOV [y],$1   | MOV [y],$2   ;
 CMP  [x],$1  | CMP  [x],$2  ;
 JE notif2    | JE notif4    ;
 MOV [b1],$0  | MOV [b2],$0  ;
 waitbar2:    | waitbar5:    ;
 CMP  [b2],$1 | CMP  [b1],$1 ;
 JE waitbar2  | JE waitbar5  ;
 CMP  [y],$1  | CMP  [y],$2  ;
 JE notif2    | JE notif4    ;
 waitbar3:    | waitbar6:    ;
 CMP  [y],$0  | CMP  [y],$0  ;
 JE while1    | JE while2    ;
 JMP waitbar3 | JMP waitbar6 ;
 notif2:      | notif4:      ;
 JMP exit1    | JMP exit2    ;
 JMP while1   | JMP while2   ;
 exit1:       | exit2:       ;
 MOV [X],$0   | MOV [X],$1   ;
 MOV EAX,[X]  | MOV EAX,[X]  ;
 MOV [y],$0   | MOV [y],$0   ;
 MOV [b1],$0  | MOV [b2],$0  ;

exists (0:EAX=1 \/ 1:EAX=0)
