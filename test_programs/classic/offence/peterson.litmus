X86 Peterson
""

{}

P0               | P1              ;
MOV [flag1], $1  | MOV [flag2], $1 ;
MOV [turn], $1   | MOV [turn], $0  ;
waitbar1:        | waitbar2:       ;
CMP [flag2], $1  | CMP [flag1], $1 ;
JE  cond1        | JE  cond2       ;
JMP waitbar1     | JMP waitbar2    ;
cond1:           | cond2:          ;
CMP [turn], $1   | CMP [turn], $0  ;
JE  exit1        | JE  exit2       ;
JMP waitbar1     | JMP waitbar2    ;
exit1:           | exit2:          ;
MOV [data], $0   | MOV [data], $1  ;
MOV EAX, [data]  | MOV EAX, [data] ;
MOV [flag1], $0  | MOV [flag2], $0 ;

exists (0:EAX=1 \/ 1:EAX=0)
